% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pGNGtwobinary.R
\name{pGNGtwobinary}
\alias{pGNGtwobinary}
\title{Calculate Go, NoGo, and Gray Probabilities for a Clinical Trial with Two Binary Endpoints
Under the Bayesian Framework}
\usage{
pGNGtwobinary(
  nsim = 10000,
  prob = "posterior",
  design = "controlled",
  theta.TV1,
  theta.MAV1,
  theta.TV2,
  theta.MAV2,
  theta.NULL1 = NULL,
  theta.NULL2 = NULL,
  gammaG1 = NULL,
  gammaN1 = NULL,
  gammaG2 = NULL,
  gammaN2 = NULL,
  decision_criteria = 1,
  pi1,
  pi2,
  a1_00,
  a1_01,
  a1_10,
  a1_11,
  a2_00,
  a2_01,
  a2_10,
  a2_11,
  n1,
  n2,
  m1 = NULL,
  m2 = NULL,
  z = NULL,
  xe1_00 = NULL,
  xe1_01 = NULL,
  xe1_10 = NULL,
  xe1_11 = NULL,
  xe2_00 = NULL,
  xe2_01 = NULL,
  xe2_10 = NULL,
  xe2_11 = NULL,
  ae1 = NULL,
  ae2 = NULL,
  Go1_regions = NULL,
  NoGo1_regions = NULL,
  Go2_regions = NULL,
  NoGo2_regions = NULL,
  error_if_Miss = TRUE,
  Gray_inc_Miss = TRUE,
  nMC = 10000,
  seed = NULL
)
}
\arguments{
\item{nsim}{A positive integer representing the number of simulation iterations
to estimate Go/NoGo/Gray probabilities. Default is 10000.}

\item{prob}{A character string specifying the type of probability to use for
decision-making. Options are \code{'posterior'} for posterior probability
or \code{'predictive'} for posterior predictive probability.}

\item{design}{A character string specifying the type of trial design. Options are
\code{'controlled'} for randomized controlled trials, \code{'uncontrolled'}
for single-arm studies, or \code{'external'} for designs incorporating
external data.}

\item{theta.TV1}{A numeric value representing the target value threshold for
Endpoint 1 when \code{prob = 'posterior'}. This defines the upper boundary
for the "Gray" region.}

\item{theta.MAV1}{A numeric value representing the minimum acceptable value threshold
for Endpoint 1 when \code{prob = 'posterior'}. This defines the lower boundary
for the "Gray" region.}

\item{theta.TV2}{A numeric value representing the target value threshold for
Endpoint 2 when \code{prob = 'posterior'}. This defines the upper boundary
for the "Gray" region.}

\item{theta.MAV2}{A numeric value representing the minimum acceptable value threshold
for Endpoint 2 when \code{prob = 'posterior'}. This defines the lower boundary
for the "Gray" region.}

\item{theta.NULL1}{A numeric value representing the null hypothesis threshold for
Endpoint 1 when \code{prob = 'predictive'}. Required when \code{prob = 'predictive'},
set to NULL if \code{prob = 'posterior'}.}

\item{theta.NULL2}{A numeric value representing the null hypothesis threshold for
Endpoint 2 when \code{prob = 'predictive'}. Required when \code{prob = 'predictive'},
set to NULL if \code{prob = 'posterior'}.}

\item{gammaG1}{A numeric value in (0, 1) representing the Go threshold for Endpoint 1.
Must satisfy gammaG1 > gammaN1. Typically set to 0.7-0.9.}

\item{gammaN1}{A numeric value in (0, 1) representing the NoGo threshold for Endpoint 1.
Must satisfy gammaN1 < gammaG1. Typically set to 0.2-0.4.}

\item{gammaG2}{A numeric value in (0, 1) representing the Go threshold for Endpoint 2.
Must satisfy gammaG2 > gammaN2. Typically set to 0.7-0.9.}

\item{gammaN2}{A numeric value in (0, 1) representing the NoGo threshold for Endpoint 2.
Must satisfy gammaN2 < gammaG2. Typically set to 0.2-0.4.}

\item{decision_criteria}{An integer (1, 2, 3, or 4) specifying the decision rule:
\itemize{
\item \strong{1}: Equations (4)-(5) - Go if BOTH endpoints meet criteria (AND),
NoGo if BOTH endpoints meet criteria (AND)
\item \strong{2}: Equations (6)-(7) - Go if BOTH endpoints meet criteria (AND),
NoGo if EITHER endpoint meets criteria (OR)
\item \strong{3}: Equations (8)-(9) - Go if EITHER endpoint meets criteria (OR),
NoGo if BOTH endpoints meet criteria (AND)
\item \strong{4}: Equations (10)-(11) - Go if EITHER endpoint meets criteria (OR),
NoGo if EITHER endpoint meets criteria (OR)
}}

\item{pi1}{A numeric vector of length 4 representing the true joint response
probabilities for group 1 (treatment). Elements correspond to (0,0), (0,1),
(1,0), (1,1) for (Endpoint1, Endpoint2). Must sum to 1.}

\item{pi2}{A numeric vector of length 4 representing the true joint response
probabilities for group 2 (control). Elements correspond to (0,0), (0,1),
(1,0), (1,1) for (Endpoint1, Endpoint2). Must sum to 1.}

\item{a1_00}{A positive numeric value representing the Dirichlet prior parameter
for response pattern (0,0) in group 1.}

\item{a1_01}{A positive numeric value representing the Dirichlet prior parameter
for response pattern (0,1) in group 1.}

\item{a1_10}{A positive numeric value representing the Dirichlet prior parameter
for response pattern (1,0) in group 1.}

\item{a1_11}{A positive numeric value representing the Dirichlet prior parameter
for response pattern (1,1) in group 1.}

\item{a2_00}{A positive numeric value representing the Dirichlet prior parameter
for response pattern (0,0) in group 2.}

\item{a2_01}{A positive numeric value representing the Dirichlet prior parameter
for response pattern (0,1) in group 2.}

\item{a2_10}{A positive numeric value representing the Dirichlet prior parameter
for response pattern (1,0) in group 2.}

\item{a2_11}{A positive numeric value representing the Dirichlet prior parameter
for response pattern (1,1) in group 2.}

\item{n1}{A positive integer representing the number of patients in group 1 for
the proof-of-concept (PoC) trial.}

\item{n2}{A positive integer representing the number of patients in group 2 for
the PoC trial.}

\item{m1}{A positive integer representing the future sample size for group 1 in
the Phase III trial. Required when \code{prob = 'predictive'}, NULL otherwise.}

\item{m2}{A positive integer representing the future sample size for group 2 in
the Phase III trial. Required when \code{prob = 'predictive'}, NULL otherwise.}

\item{z}{A numeric vector of length 4 representing the hypothetical control response
counts for \code{design = 'uncontrolled'}. Elements correspond to (0,0), (0,1),
(1,0), (1,1) for (Endpoint1, Endpoint2). Must sum to n2. This specifies the
expected number of responses in each category for a hypothetical control group
based on historical data or prior knowledge. Set to NULL for controlled and
external designs.}

\item{xe1_00}{A non-negative integer representing external control data count for
response pattern (0,0) in group 1. Used when \code{design = 'external'}.}

\item{xe1_01}{A non-negative integer representing external control data count for
response pattern (0,1) in group 1. Used when \code{design = 'external'}.}

\item{xe1_10}{A non-negative integer representing external control data count for
response pattern (1,0) in group 1. Used when \code{design = 'external'}.}

\item{xe1_11}{A non-negative integer representing external control data count for
response pattern (1,1) in group 1. Used when \code{design = 'external'}.}

\item{xe2_00}{A non-negative integer representing external control data count for
response pattern (0,0) in group 2. Used when \code{design = 'external'}.}

\item{xe2_01}{A non-negative integer representing external control data count for
response pattern (0,1) in group 2. Used when \code{design = 'external'}.}

\item{xe2_10}{A non-negative integer representing external control data count for
response pattern (1,0) in group 2. Used when \code{design = 'external'}.}

\item{xe2_11}{A non-negative integer representing external control data count for
response pattern (1,1) in group 2. Used when \code{design = 'external'}.}

\item{ae1}{A numeric value in [0, 1] representing the power prior parameter for
external data in group 1. Used when \code{design = 'external'}.}

\item{ae2}{A numeric value in [0, 1] representing the power prior parameter for
external data in group 2. Used when \code{design = 'external'}.}

\item{Go1_regions}{A numeric vector specifying which regions count as Go regions
for Endpoint 1. For \code{prob = 'posterior'}: values should be between 1-9.
For \code{prob = 'predictive'}: values should be between 1-4.
Default is \code{c(1,2,3)} for posterior or \code{c(1,2)} for predictive.}

\item{NoGo1_regions}{A numeric vector specifying which regions count as NoGo regions
for Endpoint 1. For \code{prob = 'posterior'}: values should be between 1-9.
For \code{prob = 'predictive'}: values should be between 1-4.
Default is \code{c(7,8,9)} for posterior or \code{c(3,4)} for predictive.}

\item{Go2_regions}{A numeric vector specifying which regions count as Go regions
for Endpoint 2. For \code{prob = 'posterior'}: values should be between 1-9.
For \code{prob = 'predictive'}: values should be between 1-4.
Default is \code{c(1,4,7)} for posterior or \code{c(1,3)} for predictive.}

\item{NoGo2_regions}{A numeric vector specifying which regions count as NoGo regions
for Endpoint 2. For \code{prob = 'posterior'}: values should be between 1-9.
For \code{prob = 'predictive'}: values should be between 1-4.
Default is \code{c(3,6,9)} for posterior or \code{c(2,4)} for predictive.}

\item{error_if_Miss}{A logical value indicating whether to stop with an error if
positive Miss probability is detected. Default is TRUE.}

\item{Gray_inc_Miss}{A logical value indicating whether to include Miss probability
in Gray probability calculation. Default is TRUE.}

\item{nMC}{A positive integer representing the number of Monte Carlo samples for
probability estimation within each simulation iteration. Default is 10000.}

\item{seed}{An integer value for random number generator seed to ensure reproducibility.
If NULL (default), no seed is set.}
}
\value{
A data frame containing the following columns:
\describe{
\item{pi1_00, pi1_01, pi1_10, pi1_11}{The true joint probabilities for group 1}
\item{pi2_00, pi2_01, pi2_10, pi2_11}{The true joint probabilities for group 2}
\item{Go}{The probability of making a Go decision}
\item{Gray}{The probability of making a Gray (inconclusive) decision}
\item{NoGo}{The probability of making a NoGo decision}
\item{Miss}{(Optional) The probability where both Go and NoGo criteria are met
simultaneously. Included when \code{error_if_Miss = FALSE} and
\code{Gray_inc_Miss = FALSE}}
}
}
\description{
This function calculates the Go, NoGo, and Gray probabilities for clinical trials
with two binary endpoints using the Bayesian framework. The function evaluates
operating characteristics by computing the probability of making each type of
decision (Go, NoGo, or Gray) across different true response rates. The function
supports controlled, uncontrolled, and external control designs. Decision criteria
can be based on joint probabilities across the nine regions defined by target values
(TV) and minimum acceptable values (MAV) for both endpoints.
}
\details{
The function simulates clinical trial data from multinomial distributions with
specified true response probabilities, then calculates posterior or posterior
predictive probabilities for each simulated dataset using \code{pPPtwobinary()}.

\strong{Decision Regions for Posterior Probability (9 regions)}:
The nine regions are defined by the thresholds for both endpoints as follows
(regions numbered 1-9 in column-major order):
\tabular{lccc}{
\tab \strong{θ1 > TV1} \tab \strong{TV1 ≥ θ1 > MAV1} \tab \strong{MAV1 ≥ θ1} \cr
\strong{θ2 > TV2} \tab Region 1 \tab Region 4 \tab Region 7 \cr
\strong{TV2 ≥ θ2 > MAV2} \tab Region 2 \tab Region 5 \tab Region 8 \cr
\strong{MAV2 ≥ θ2} \tab Region 3 \tab Region 6 \tab Region 9
}

\strong{Decision Regions for Predictive Probability (4 regions)}:
The four regions are defined by the NULL hypothesis thresholds for both endpoints
(regions numbered 1-4 in column-major order):
\tabular{lcc}{
\tab \strong{θ1 > NULL1} \tab \strong{NULL1 ≥ θ1} \cr
\strong{θ2 > NULL2} \tab Region 1 \tab Region 3 \cr
\strong{NULL2 ≥ θ2} \tab Region 2 \tab Region 4
}

\strong{Decision Criteria} (corresponding to Documentation.pdf equations):
\itemize{
\item \strong{Criteria 1} - Equations (4)-(5): AND/AND decision
\itemize{
\item Go: Pr(Endpoint1 success) >= gammaG1 AND Pr(Endpoint2 success) >= gammaG2
\item NoGo: Pr(Endpoint1 failure) >= gammaN1 AND Pr(Endpoint2 failure) >= gammaN2
}
\item \strong{Criteria 2} - Equations (6)-(7): AND/OR decision
\itemize{
\item Go: Pr(Endpoint1 success) >= gammaG1 AND Pr(Endpoint2 success) >= gammaG2
\item NoGo: Pr(Endpoint1 failure) >= gammaN1 OR Pr(Endpoint2 failure) >= gammaN2
}
\item \strong{Criteria 3} - Equations (8)-(9): OR/AND decision
\itemize{
\item Go: Pr(Endpoint1 success) >= gammaG1 OR Pr(Endpoint2 success) >= gammaG2
\item NoGo: Pr(Endpoint1 failure) >= gammaN1 AND Pr(Endpoint2 failure) >= gammaN2
}
\item \strong{Criteria 4} - Equations (10)-(11): OR/OR decision
\itemize{
\item Go: Pr(Endpoint1 success) >= gammaG1 OR Pr(Endpoint2 success) >= gammaG2
\item NoGo: Pr(Endpoint1 failure) >= gammaN1 OR Pr(Endpoint2 failure) >= gammaN2
}
}

\strong{Gray Decision}: Made when neither Go nor NoGo criteria are met (the complement).

\strong{Miss Decision}: Occurs when both Go and NoGo criteria are met simultaneously,
which should be rare with appropriate threshold selection.
}
\examples{
# Example 1: Decision criteria 1 - Equations (4)-(5): AND/AND decision
result1 <- pGNGtwobinary(
  nsim = 1000, prob = 'posterior', design = 'controlled',
  theta.TV1 = 0.20, theta.MAV1 = 0.10,
  theta.TV2 = 0.20, theta.MAV2 = 0.10,
  theta.NULL1 = NULL, theta.NULL2 = NULL,
  gammaG1 = 0.80, gammaN1 = 0.20,
  gammaG2 = 0.80, gammaN2 = 0.20,
  decision_criteria = 1,
  pi1 = c(0.25, 0.20, 0.20, 0.35),
  pi2 = c(0.40, 0.25, 0.25, 0.10),
  a1_00 = 0.5, a1_01 = 0.5, a1_10 = 0.5, a1_11 = 0.5,
  a2_00 = 0.5, a2_01 = 0.5, a2_10 = 0.5, a2_11 = 0.5,
  n1 = 15, n2 = 15, m1 = NULL, m2 = NULL,
  xe1_00 = NULL, xe1_01 = NULL, xe1_10 = NULL, xe1_11 = NULL,
  xe2_00 = NULL, xe2_01 = NULL, xe2_10 = NULL, xe2_11 = NULL,
  ae1 = NULL, ae2 = NULL,
  nMC = 10000, seed = 123
)
print(result1)

# Example 2: Decision criteria 2 - Equations (6)-(7): AND/OR decision
result2 <- pGNGtwobinary(
  nsim = 1000, prob = 'posterior', design = 'controlled',
  theta.TV1 = 0.20, theta.MAV1 = 0.10,
  theta.TV2 = 0.20, theta.MAV2 = 0.10,
  theta.NULL1 = NULL, theta.NULL2 = NULL,
  gammaG1 = 0.70, gammaN1 = 0.30,
  gammaG2 = 0.70, gammaN2 = 0.30,
  decision_criteria = 2,
  pi1 = c(0.25, 0.20, 0.20, 0.35),
  pi2 = c(0.40, 0.25, 0.25, 0.10),
  a1_00 = 0.5, a1_01 = 0.5, a1_10 = 0.5, a1_11 = 0.5,
  a2_00 = 0.5, a2_01 = 0.5, a2_10 = 0.5, a2_11 = 0.5,
  n1 = 15, n2 = 15, m1 = NULL, m2 = NULL,
  xe1_00 = NULL, xe1_01 = NULL, xe1_10 = NULL, xe1_11 = NULL,
  xe2_00 = NULL, xe2_01 = NULL, xe2_10 = NULL, xe2_11 = NULL,
  ae1 = NULL, ae2 = NULL,
  nMC = 10000, seed = 124
)
print(result2)

# Example 3: Decision criteria 3 - Equations (8)-(9): OR/AND decision
result3 <- pGNGtwobinary(
  nsim = 1000, prob = 'posterior', design = 'controlled',
  theta.TV1 = 0.20, theta.MAV1 = 0.10,
  theta.TV2 = 0.20, theta.MAV2 = 0.10,
  theta.NULL1 = NULL, theta.NULL2 = NULL,
  gammaG1 = 0.75, gammaN1 = 0.25,
  gammaG2 = 0.75, gammaN2 = 0.25,
  decision_criteria = 3,
  pi1 = c(0.25, 0.20, 0.20, 0.35),
  pi2 = c(0.40, 0.25, 0.25, 0.10),
  a1_00 = 0.5, a1_01 = 0.5, a1_10 = 0.5, a1_11 = 0.5,
  a2_00 = 0.5, a2_01 = 0.5, a2_10 = 0.5, a2_11 = 0.5,
  n1 = 15, n2 = 15, m1 = NULL, m2 = NULL,
  xe1_00 = NULL, xe1_01 = NULL, xe1_10 = NULL, xe1_11 = NULL,
  xe2_00 = NULL, xe2_01 = NULL, xe2_10 = NULL, xe2_11 = NULL,
  ae1 = NULL, ae2 = NULL,
  nMC = 10000, seed = 125
)
print(result3)

# Example 4: Decision criteria 4 - Equations (10)-(11): OR/OR decision
result4 <- pGNGtwobinary(
  nsim = 500, prob = 'posterior', design = 'controlled',
  theta.TV1 = 0.15, theta.MAV1 = 0.08,
  theta.TV2 = 0.15, theta.MAV2 = 0.08,
  theta.NULL1 = NULL, theta.NULL2 = NULL,
  gammaG1 = 0.80, gammaN1 = 0.20,
  gammaG2 = 0.80, gammaN2 = 0.20,
  decision_criteria = 4,
  pi1 = c(0.30, 0.18, 0.18, 0.34),
  pi2 = c(0.45, 0.22, 0.22, 0.11),
  a1_00 = 0.5, a1_01 = 0.5, a1_10 = 0.5, a1_11 = 0.5,
  a2_00 = 0.5, a2_01 = 0.5, a2_10 = 0.5, a2_11 = 0.5,
  n1 = 15, n2 = 15, m1 = NULL, m2 = NULL,
  xe1_00 = NULL, xe1_01 = NULL, xe1_10 = NULL, xe1_11 = NULL,
  xe2_00 = NULL, xe2_01 = NULL, xe2_10 = NULL, xe2_11 = NULL,
  ae1 = NULL, ae2 = NULL,
  error_if_Miss = FALSE, Gray_inc_Miss = FALSE,
  nMC = 10000, seed = 126
)
print(result4)

# Example 5: Posterior predictive probability with decision criteria 1
result5 <- pGNGtwobinary(
  nsim = 1000, prob = 'predictive', design = 'controlled',
  theta.TV1 = 0.15, theta.MAV1 = 0.15,
  theta.TV2 = 0.15, theta.MAV2 = 0.15,
  theta.NULL1 = 0.15, theta.NULL2 = 0.15,
  gammaG1 = 0.75, gammaN1 = 0.25,
  gammaG2 = 0.75, gammaN2 = 0.25,
  decision_criteria = 1,
  pi1 = c(0.30, 0.15, 0.15, 0.40),
  pi2 = c(0.45, 0.20, 0.20, 0.15),
  a1_00 = 1, a1_01 = 1, a1_10 = 1, a1_11 = 1,
  a2_00 = 1, a2_01 = 1, a2_10 = 1, a2_11 = 1,
  n1 = 20, n2 = 20, m1 = 50, m2 = 50,
  xe1_00 = NULL, xe1_01 = NULL, xe1_10 = NULL, xe1_11 = NULL,
  xe2_00 = NULL, xe2_01 = NULL, xe2_10 = NULL, xe2_11 = NULL,
  ae1 = NULL, ae2 = NULL,
  nMC = 10000, seed = 127
)
print(result5)

# Example 6: External control design with decision criteria 2
result6 <- pGNGtwobinary(
  nsim = 500, prob = 'posterior', design = 'external',
  theta.TV1 = 0.15, theta.MAV1 = 0.08,
  theta.TV2 = 0.15, theta.MAV2 = 0.08,
  theta.NULL1 = NULL, theta.NULL2 = NULL,
  gammaG1 = 0.80, gammaN1 = 0.20,
  gammaG2 = 0.80, gammaN2 = 0.20,
  decision_criteria = 2,
  pi1 = c(0.30, 0.18, 0.18, 0.34),
  pi2 = c(0.45, 0.22, 0.22, 0.11),
  a1_00 = 0.5, a1_01 = 0.5, a1_10 = 0.5, a1_11 = 0.5,
  a2_00 = 0.5, a2_01 = 0.5, a2_10 = 0.5, a2_11 = 0.5,
  n1 = 15, n2 = 15, m1 = NULL, m2 = NULL,
  xe1_00 = 5, xe1_01 = 3, xe1_10 = 3, xe1_11 = 9,
  xe2_00 = 10, xe2_01 = 5, xe2_10 = 5, xe2_11 = 5,
  ae1 = 0.5, ae2 = 0.5,
  nMC = 10000, seed = 128
)
print(result6)

# Example 7: Uncontrolled design with hypothetical control and decision criteria 3
result7 <- pGNGtwobinary(
  nsim = 1000, prob = 'posterior', design = 'uncontrolled',
  theta.TV1 = 0.20, theta.MAV1 = 0.10,
  theta.TV2 = 0.20, theta.MAV2 = 0.10,
  theta.NULL1 = NULL, theta.NULL2 = NULL,
  gammaG1 = 0.80, gammaN1 = 0.20,
  gammaG2 = 0.80, gammaN2 = 0.20,
  decision_criteria = 3,
  pi1 = c(0.25, 0.20, 0.20, 0.35),
  pi2 = c(0.40, 0.25, 0.25, 0.10),  # Not used for uncontrolled
  a1_00 = 0.5, a1_01 = 0.5, a1_10 = 0.5, a1_11 = 0.5,
  a2_00 = 0.5, a2_01 = 0.5, a2_10 = 0.5, a2_11 = 0.5,
  n1 = 20, n2 = 20, m1 = NULL, m2 = NULL,
  z = c(8, 5, 5, 2),  # Hypothetical control: 8 for (0,0), 5 for (0,1), etc.
  xe1_00 = NULL, xe1_01 = NULL, xe1_10 = NULL, xe1_11 = NULL,
  xe2_00 = NULL, xe2_01 = NULL, xe2_10 = NULL, xe2_11 = NULL,
  ae1 = NULL, ae2 = NULL,
  nMC = 10000, seed = 129
)
print(result7)

}
