<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Bayesian Decision Making for Continuous Endpoints • BayesianQDM</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bayesian Decision Making for Continuous Endpoints">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BayesianQDM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/BayesianQDM.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/BayesianQDM.html">Introduction to BayesianQDM</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/binary-endpoints.html">Binary Endpoints</a></li>
    <li><a class="dropdown-item" href="../articles/continuous-endpoints.html">Continuous Endpoints</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gosukehommaEX/BayesianQDM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Bayesian Decision Making for Continuous Endpoints</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/gosukehommaEX/BayesianQDM/blob/HEAD/vignettes/continuous-endpoints.Rmd" class="external-link"><code>vignettes/continuous-endpoints.Rmd</code></a></small>
      <div class="d-none name"><code>continuous-endpoints.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gosukehommaEX.github.io/BayesianQDM/">BayesianQDM</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette demonstrates Bayesian decision-making for continuous
endpoints using the BayesianQDM package. Continuous endpoints (e.g.,
change in biomarker levels, symptom scores, or quality of life measures)
are common in clinical trials and require different statistical
approaches than binary endpoints.</p>
</div>
<div class="section level2">
<h2 id="theoretical-background">Theoretical Background<a class="anchor" aria-label="anchor" href="#theoretical-background"></a>
</h2>
<div class="section level3">
<h3 id="statistical-framework">Statistical Framework<a class="anchor" aria-label="anchor" href="#statistical-framework"></a>
</h3>
<p>For continuous endpoints, we assume: - Outcomes follow normal
distributions with unknown means and variances - Prior distributions on
parameters (Normal-Inverse-Chi-squared or vague priors) - Posterior
distributions follow t-distributions</p>
</div>
<div class="section level3">
<h3 id="calculation-methods">Calculation Methods<a class="anchor" aria-label="anchor" href="#calculation-methods"></a>
</h3>
<p>The package provides three computational approaches:</p>
<ol style="list-style-type: decimal">
<li>
<strong>NI (Numerical Integration)</strong>: Exact calculation using
convolution</li>
<li>
<strong>WS (Welch-Satterthwaite)</strong>: Fast approximation for
unequal variances<br>
</li>
<li>
<strong>MC (Monte Carlo)</strong>: Simulation-based approach</li>
</ol>
<p>For this vignette, we focus on the fastest methods (NI and WS) to
ensure reasonable build times.</p>
</div>
</div>
<div class="section level2">
<h2 id="basic-examples">Basic Examples<a class="anchor" aria-label="anchor" href="#basic-examples"></a>
</h2>
<div class="section level3">
<h3 id="posterior-probability">Posterior Probability<a class="anchor" aria-label="anchor" href="#posterior-probability"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate posterior probability using NI method</span></span>
<span><span class="va">posterior_prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pPPsinglecontinuous.html">pPPsinglecontinuous</a></span><span class="op">(</span></span>
<span>  prob <span class="op">=</span> <span class="st">'posterior'</span>, </span>
<span>  design <span class="op">=</span> <span class="st">'controlled'</span>, </span>
<span>  prior <span class="op">=</span> <span class="st">'vague'</span>, </span>
<span>  CalcMethod <span class="op">=</span> <span class="st">'NI'</span>,</span>
<span>  theta0 <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>  n1 <span class="op">=</span> <span class="fl">20</span>, n2 <span class="op">=</span> <span class="fl">20</span>, </span>
<span>  bar.y1 <span class="op">=</span> <span class="fl">5.2</span>, bar.y2 <span class="op">=</span> <span class="fl">3.0</span>, </span>
<span>  s1 <span class="op">=</span> <span class="fl">2.0</span>, s2 <span class="op">=</span> <span class="fl">1.8</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Posterior probability that treatment effect &gt; 1.5:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">posterior_prob</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Posterior probability that treatment effect &gt; 1.5: 0.1323</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="comparing-calculation-methods">Comparing Calculation Methods<a class="anchor" aria-label="anchor" href="#comparing-calculation-methods"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compare NI and WS methods</span></span>
<span><span class="va">prob_ni</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pPPsinglecontinuous.html">pPPsinglecontinuous</a></span><span class="op">(</span></span>
<span>  prob <span class="op">=</span> <span class="st">'posterior'</span>, design <span class="op">=</span> <span class="st">'controlled'</span>, prior <span class="op">=</span> <span class="st">'vague'</span>, CalcMethod <span class="op">=</span> <span class="st">'NI'</span>,</span>
<span>  theta0 <span class="op">=</span> <span class="fl">1.5</span>, n1 <span class="op">=</span> <span class="fl">15</span>, n2 <span class="op">=</span> <span class="fl">15</span>, bar.y1 <span class="op">=</span> <span class="fl">5</span>, bar.y2 <span class="op">=</span> <span class="fl">3</span>, s1 <span class="op">=</span> <span class="fl">2</span>, s2 <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">prob_ws</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pPPsinglecontinuous.html">pPPsinglecontinuous</a></span><span class="op">(</span></span>
<span>  prob <span class="op">=</span> <span class="st">'posterior'</span>, design <span class="op">=</span> <span class="st">'controlled'</span>, prior <span class="op">=</span> <span class="st">'vague'</span>, CalcMethod <span class="op">=</span> <span class="st">'WS'</span>,</span>
<span>  theta0 <span class="op">=</span> <span class="fl">1.5</span>, n1 <span class="op">=</span> <span class="fl">15</span>, n2 <span class="op">=</span> <span class="fl">15</span>, bar.y1 <span class="op">=</span> <span class="fl">5</span>, bar.y2 <span class="op">=</span> <span class="fl">3</span>, s1 <span class="op">=</span> <span class="fl">2</span>, s2 <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"NI method:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">prob_ni</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; NI method: 0.2572</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"WS method:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">prob_ws</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; WS method: 0.2496</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Difference:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">prob_ni</span> <span class="op">-</span> <span class="va">prob_ws</span><span class="op">)</span>, <span class="fl">6</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Difference: 0.00763</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="gonogogray-decision-probabilities">Go/NoGo/Gray Decision Probabilities<a class="anchor" aria-label="anchor" href="#gonogogray-decision-probabilities"></a>
</h2>
<div class="section level3">
<h3 id="basic-usage">Basic Usage<a class="anchor" aria-label="anchor" href="#basic-usage"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate Go/NoGo/Gray probabilities</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pGNGsinglecontinuous.html">pGNGsinglecontinuous</a></span><span class="op">(</span></span>
<span>  nsim <span class="op">=</span> <span class="fl">50</span>,  <span class="co"># Small nsim for vignette speed</span></span>
<span>  prob <span class="op">=</span> <span class="st">'posterior'</span>, </span>
<span>  design <span class="op">=</span> <span class="st">'controlled'</span>, </span>
<span>  prior <span class="op">=</span> <span class="st">'vague'</span>, </span>
<span>  CalcMethod <span class="op">=</span> <span class="st">'WS'</span>,</span>
<span>  theta.TV <span class="op">=</span> <span class="fl">1.5</span>, theta.MAV <span class="op">=</span> <span class="fl">0.5</span>, theta.NULL <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nMC <span class="op">=</span> <span class="cn">NULL</span>, gamma1 <span class="op">=</span> <span class="fl">0.8</span>, gamma2 <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  n1 <span class="op">=</span> <span class="fl">20</span>, n2 <span class="op">=</span> <span class="fl">20</span>, m1 <span class="op">=</span> <span class="cn">NULL</span>, m2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  kappa01 <span class="op">=</span> <span class="cn">NULL</span>, kappa02 <span class="op">=</span> <span class="cn">NULL</span>, nu01 <span class="op">=</span> <span class="cn">NULL</span>, nu02 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mu01 <span class="op">=</span> <span class="cn">NULL</span>, mu02 <span class="op">=</span> <span class="cn">NULL</span>, sigma01 <span class="op">=</span> <span class="cn">NULL</span>, sigma02 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mu1 <span class="op">=</span> <span class="fl">5.0</span>, mu2 <span class="op">=</span> <span class="fl">3.0</span>, sigma1 <span class="op">=</span> <span class="fl">2.0</span>, sigma2 <span class="op">=</span> <span class="fl">1.8</span>,</span>
<span>  r <span class="op">=</span> <span class="cn">NULL</span>, ne1 <span class="op">=</span> <span class="cn">NULL</span>, ne2 <span class="op">=</span> <span class="cn">NULL</span>, alpha01 <span class="op">=</span> <span class="cn">NULL</span>, alpha02 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bar.ye1 <span class="op">=</span> <span class="cn">NULL</span>, bar.ye2 <span class="op">=</span> <span class="cn">NULL</span>, se1 <span class="op">=</span> <span class="cn">NULL</span>, se2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">123</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="co">#&gt;   mu1 mu2   Go Gray NoGo</span></span>
<span><span class="co">#&gt; 1   5   3 0.46 0.52 0.02</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="operating-characteristics">Operating Characteristics<a class="anchor" aria-label="anchor" href="#operating-characteristics"></a>
</h2>
<div class="section level3">
<h3 id="evaluating-across-treatment-effects">Evaluating Across Treatment Effects<a class="anchor" aria-label="anchor" href="#evaluating-across-treatment-effects"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Evaluate OC across different treatment effects</span></span>
<span><span class="va">mu1_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">7</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">oc_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">mu1_values</span>, <span class="kw">function</span><span class="op">(</span><span class="va">m1</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pGNGsinglecontinuous.html">pGNGsinglecontinuous</a></span><span class="op">(</span></span>
<span>    nsim <span class="op">=</span> <span class="fl">30</span>,  <span class="co"># Reduced for vignette speed</span></span>
<span>    prob <span class="op">=</span> <span class="st">'posterior'</span>, design <span class="op">=</span> <span class="st">'controlled'</span>, prior <span class="op">=</span> <span class="st">'vague'</span>, CalcMethod <span class="op">=</span> <span class="st">'WS'</span>,</span>
<span>    theta.TV <span class="op">=</span> <span class="fl">1.5</span>, theta.MAV <span class="op">=</span> <span class="fl">0.5</span>, theta.NULL <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    nMC <span class="op">=</span> <span class="cn">NULL</span>, gamma1 <span class="op">=</span> <span class="fl">0.8</span>, gamma2 <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>    n1 <span class="op">=</span> <span class="fl">30</span>, n2 <span class="op">=</span> <span class="fl">30</span>, m1 <span class="op">=</span> <span class="cn">NULL</span>, m2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    kappa01 <span class="op">=</span> <span class="cn">NULL</span>, kappa02 <span class="op">=</span> <span class="cn">NULL</span>, nu01 <span class="op">=</span> <span class="cn">NULL</span>, nu02 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    mu01 <span class="op">=</span> <span class="cn">NULL</span>, mu02 <span class="op">=</span> <span class="cn">NULL</span>, sigma01 <span class="op">=</span> <span class="cn">NULL</span>, sigma02 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    mu1 <span class="op">=</span> <span class="va">m1</span>, mu2 <span class="op">=</span> <span class="fl">3</span>, sigma1 <span class="op">=</span> <span class="fl">2</span>, sigma2 <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    r <span class="op">=</span> <span class="cn">NULL</span>, ne1 <span class="op">=</span> <span class="cn">NULL</span>, ne2 <span class="op">=</span> <span class="cn">NULL</span>, alpha01 <span class="op">=</span> <span class="cn">NULL</span>, alpha02 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    bar.ye1 <span class="op">=</span> <span class="cn">NULL</span>, bar.ye2 <span class="op">=</span> <span class="cn">NULL</span>, se1 <span class="op">=</span> <span class="cn">NULL</span>, se2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    seed <span class="op">=</span> <span class="fl">123</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    mu1 <span class="op">=</span> <span class="va">m1</span>,</span>
<span>    treatment_effect <span class="op">=</span> <span class="va">m1</span> <span class="op">-</span> <span class="fl">3</span>,</span>
<span>    go_prob <span class="op">=</span> <span class="va">result</span><span class="op">$</span><span class="va">Go</span>,</span>
<span>    nogo_prob <span class="op">=</span> <span class="va">result</span><span class="op">$</span><span class="va">NoGo</span>,</span>
<span>    gray_prob <span class="op">=</span> <span class="va">result</span><span class="op">$</span><span class="va">Gray</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">oc_results</span><span class="op">)</span></span>
<span><span class="co">#&gt;   mu1 treatment_effect   go_prob  nogo_prob  gray_prob</span></span>
<span><span class="co">#&gt; 1   3                0 0.0000000 0.96666667 0.03333333</span></span>
<span><span class="co">#&gt; 2   4                1 0.0000000 0.23333333 0.76666667</span></span>
<span><span class="co">#&gt; 3   5                2 0.6000000 0.03333333 0.36666667</span></span>
<span><span class="co">#&gt; 4   6                3 0.9333333 0.00000000 0.06666667</span></span>
<span><span class="co">#&gt; 5   7                4 1.0000000 0.00000000 0.00000000</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visualizing-operating-characteristics">Visualizing Operating Characteristics<a class="anchor" aria-label="anchor" href="#visualizing-operating-characteristics"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Reshape for plotting</span></span>
<span><span class="va">plot_data</span> <span class="op">&lt;-</span> <span class="va">oc_results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">go_prob</span>, <span class="va">gray_prob</span>, <span class="va">nogo_prob</span><span class="op">)</span>, </span>
<span>               names_to <span class="op">=</span> <span class="st">"decision"</span>, </span>
<span>               values_to <span class="op">=</span> <span class="st">"probability"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Decision <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>    <span class="va">decision</span> <span class="op">==</span> <span class="st">"go_prob"</span> <span class="op">~</span> <span class="st">"Go"</span>,</span>
<span>    <span class="va">decision</span> <span class="op">==</span> <span class="st">"gray_prob"</span> <span class="op">~</span> <span class="st">"Gray"</span>,</span>
<span>    <span class="va">decision</span> <span class="op">==</span> <span class="st">"nogo_prob"</span> <span class="op">~</span> <span class="st">"NoGo"</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">plot_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">treatment_effect</span>, y <span class="op">=</span> <span class="va">probability</span>, color <span class="op">=</span> <span class="va">Decision</span>, linetype <span class="op">=</span> <span class="va">Decision</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Go"</span> <span class="op">=</span> <span class="st">"#2E8B57"</span>, <span class="st">"Gray"</span> <span class="op">=</span> <span class="st">"#DAA520"</span>, <span class="st">"NoGo"</span> <span class="op">=</span> <span class="st">"#DC143C"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_linetype_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Go"</span> <span class="op">=</span> <span class="st">"solid"</span>, <span class="st">"Gray"</span> <span class="op">=</span> <span class="st">"dashed"</span>, <span class="st">"NoGo"</span> <span class="op">=</span> <span class="st">"dotted"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Operating Characteristics: Decision Probabilities"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Sample size = 30 per arm, σ = 2"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"True Treatment Effect (μ₁ - μ₂)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Decision Probability"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Decision"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/percent_format.html" class="external-link">percent</a></span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="continuous-endpoints_files/figure-html/oc_plot-1.png" alt="Visualization of statistical methods and decision probabilities for continuous endpoints" width="768"></p>
</div>
</div>
<div class="section level2">
<h2 id="prior-specification">Prior Specification<a class="anchor" aria-label="anchor" href="#prior-specification"></a>
</h2>
<div class="section level3">
<h3 id="informative-vs-vague-priors">Informative vs Vague Priors<a class="anchor" aria-label="anchor" href="#informative-vs-vague-priors"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Vague prior</span></span>
<span><span class="va">prob_vague</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pPPsinglecontinuous.html">pPPsinglecontinuous</a></span><span class="op">(</span></span>
<span>  prob <span class="op">=</span> <span class="st">'posterior'</span>, design <span class="op">=</span> <span class="st">'controlled'</span>, prior <span class="op">=</span> <span class="st">'vague'</span>, CalcMethod <span class="op">=</span> <span class="st">'NI'</span>,</span>
<span>  theta0 <span class="op">=</span> <span class="fl">1.5</span>, n1 <span class="op">=</span> <span class="fl">15</span>, n2 <span class="op">=</span> <span class="fl">15</span>, bar.y1 <span class="op">=</span> <span class="fl">5</span>, bar.y2 <span class="op">=</span> <span class="fl">3</span>, s1 <span class="op">=</span> <span class="fl">2</span>, s2 <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Informative prior (Normal-Inverse-Chi-squared)</span></span>
<span><span class="va">prob_informative</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pPPsinglecontinuous.html">pPPsinglecontinuous</a></span><span class="op">(</span></span>
<span>  prob <span class="op">=</span> <span class="st">'posterior'</span>, design <span class="op">=</span> <span class="st">'controlled'</span>, prior <span class="op">=</span> <span class="st">'N-Inv-Chisq'</span>, CalcMethod <span class="op">=</span> <span class="st">'NI'</span>,</span>
<span>  theta0 <span class="op">=</span> <span class="fl">1.5</span>, n1 <span class="op">=</span> <span class="fl">15</span>, n2 <span class="op">=</span> <span class="fl">15</span>,</span>
<span>  kappa01 <span class="op">=</span> <span class="fl">5</span>, kappa02 <span class="op">=</span> <span class="fl">5</span>, nu01 <span class="op">=</span> <span class="fl">10</span>, nu02 <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  mu01 <span class="op">=</span> <span class="fl">5</span>, mu02 <span class="op">=</span> <span class="fl">3</span>, sigma01 <span class="op">=</span> <span class="fl">2</span>, sigma02 <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  bar.y1 <span class="op">=</span> <span class="fl">5</span>, bar.y2 <span class="op">=</span> <span class="fl">3</span>, s1 <span class="op">=</span> <span class="fl">2</span>, s2 <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Vague prior:       "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">prob_vague</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Vague prior:        0.2572</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Informative prior: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">prob_informative</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Informative prior:  0.4126</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="external-control-design">External Control Design<a class="anchor" aria-label="anchor" href="#external-control-design"></a>
</h2>
<div class="section level3">
<h3 id="power-prior-with-historical-data">Power Prior with Historical Data<a class="anchor" aria-label="anchor" href="#power-prior-with-historical-data"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Incorporating external control data</span></span>
<span><span class="va">external_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pPPsinglecontinuous.html">pPPsinglecontinuous</a></span><span class="op">(</span></span>
<span>  prob <span class="op">=</span> <span class="st">'posterior'</span>,</span>
<span>  design <span class="op">=</span> <span class="st">'external'</span>,</span>
<span>  prior <span class="op">=</span> <span class="st">'vague'</span>,</span>
<span>  CalcMethod <span class="op">=</span> <span class="st">'WS'</span>,</span>
<span>  theta0 <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>  n1 <span class="op">=</span> <span class="fl">20</span>, n2 <span class="op">=</span> <span class="fl">20</span>,           <span class="co"># Current trial</span></span>
<span>  bar.y1 <span class="op">=</span> <span class="fl">5.5</span>, bar.y2 <span class="op">=</span> <span class="fl">3.2</span>,</span>
<span>  s1 <span class="op">=</span> <span class="fl">2.1</span>, s2 <span class="op">=</span> <span class="fl">1.9</span>,</span>
<span>  ne1 <span class="op">=</span> <span class="cn">NULL</span>, ne2 <span class="op">=</span> <span class="fl">40</span>,       <span class="co"># External control only</span></span>
<span>  alpha01 <span class="op">=</span> <span class="cn">NULL</span>, alpha02 <span class="op">=</span> <span class="fl">0.5</span>,  <span class="co"># 50% borrowing</span></span>
<span>  bar.ye1 <span class="op">=</span> <span class="cn">NULL</span>, bar.ye2 <span class="op">=</span> <span class="fl">3.0</span>,  <span class="co"># Historical control mean</span></span>
<span>  se1 <span class="op">=</span> <span class="cn">NULL</span>, se2 <span class="op">=</span> <span class="fl">2.0</span>           <span class="co"># Historical control SD</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Posterior probability with external control:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">external_result</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Posterior probability with external control: 0.0581</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="sensitivity-to-power-prior-parameter">Sensitivity to Power Prior Parameter<a class="anchor" aria-label="anchor" href="#sensitivity-to-power-prior-parameter"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Test different levels of borrowing</span></span>
<span><span class="va">alpha_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">borrowing_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  alpha <span class="op">=</span> <span class="va">alpha_values</span>,</span>
<span>  probability <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">alpha_values</span>, <span class="kw">function</span><span class="op">(</span><span class="va">a</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/pPPsinglecontinuous.html">pPPsinglecontinuous</a></span><span class="op">(</span></span>
<span>      prob <span class="op">=</span> <span class="st">'posterior'</span>, design <span class="op">=</span> <span class="st">'external'</span>, prior <span class="op">=</span> <span class="st">'vague'</span>, CalcMethod <span class="op">=</span> <span class="st">'WS'</span>,</span>
<span>      theta0 <span class="op">=</span> <span class="fl">1.5</span>, n1 <span class="op">=</span> <span class="fl">20</span>, n2 <span class="op">=</span> <span class="fl">20</span>, bar.y1 <span class="op">=</span> <span class="fl">5.5</span>, bar.y2 <span class="op">=</span> <span class="fl">3.2</span>, s1 <span class="op">=</span> <span class="fl">2.1</span>, s2 <span class="op">=</span> <span class="fl">1.9</span>,</span>
<span>      ne1 <span class="op">=</span> <span class="cn">NULL</span>, ne2 <span class="op">=</span> <span class="fl">40</span>, alpha01 <span class="op">=</span> <span class="cn">NULL</span>, alpha02 <span class="op">=</span> <span class="va">a</span>,</span>
<span>      bar.ye1 <span class="op">=</span> <span class="cn">NULL</span>, bar.ye2 <span class="op">=</span> <span class="fl">3.0</span>, se1 <span class="op">=</span> <span class="cn">NULL</span>, se2 <span class="op">=</span> <span class="fl">2.0</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">borrowing_results</span><span class="op">)</span></span>
<span><span class="co">#&gt;   alpha probability</span></span>
<span><span class="co">#&gt; 1   0.0  0.10459681</span></span>
<span><span class="co">#&gt; 2   0.2  0.07720469</span></span>
<span><span class="co">#&gt; 3   0.4  0.06291360</span></span>
<span><span class="co">#&gt; 4   0.6  0.05433216</span></span>
<span><span class="co">#&gt; 5   0.8  0.04867937</span></span>
<span><span class="co">#&gt; 6   1.0  0.04470432</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">borrowing_results</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">alpha</span>, y <span class="op">=</span> <span class="va">probability</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1.2</span>, color <span class="op">=</span> <span class="st">'#2E8B57'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span>, color <span class="op">=</span> <span class="st">'#2E8B57'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Sensitivity to Historical Data Borrowing"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Power Prior Parameter (α)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Posterior Probability"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"α = 0: no borrowing, α = 1: full borrowing"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/percent_format.html" class="external-link">percent</a></span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="continuous-endpoints_files/figure-html/borrowing_plot-1.png" alt="Visualization of statistical methods and decision probabilities for continuous endpoints" width="672"></p>
</div>
</div>
<div class="section level2">
<h2 id="sample-size-and-power">Sample Size and Power<a class="anchor" aria-label="anchor" href="#sample-size-and-power"></a>
</h2>
<div class="section level3">
<h3 id="power-analysis-across-sample-sizes">Power Analysis Across Sample Sizes<a class="anchor" aria-label="anchor" href="#power-analysis-across-sample-sizes"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Evaluate optimal sample size for desired operating characteristics</span></span>
<span><span class="va">sample_sizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">50</span>, by <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="va">oc_results_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">sample_sizes</span>, <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pGNGsinglecontinuous.html">pGNGsinglecontinuous</a></span><span class="op">(</span></span>
<span>    nsim <span class="op">=</span> <span class="fl">30</span>,  <span class="co"># Reduced for vignette speed</span></span>
<span>    prob <span class="op">=</span> <span class="st">'posterior'</span>, design <span class="op">=</span> <span class="st">'controlled'</span>, prior <span class="op">=</span> <span class="st">'vague'</span>, CalcMethod <span class="op">=</span> <span class="st">'WS'</span>,</span>
<span>    theta.TV <span class="op">=</span> <span class="fl">1.5</span>, theta.MAV <span class="op">=</span> <span class="fl">0.5</span>, theta.NULL <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    nMC <span class="op">=</span> <span class="cn">NULL</span>, gamma1 <span class="op">=</span> <span class="fl">0.8</span>, gamma2 <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>    n1 <span class="op">=</span> <span class="va">n</span>, n2 <span class="op">=</span> <span class="va">n</span>, m1 <span class="op">=</span> <span class="cn">NULL</span>, m2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    kappa01 <span class="op">=</span> <span class="cn">NULL</span>, kappa02 <span class="op">=</span> <span class="cn">NULL</span>, nu01 <span class="op">=</span> <span class="cn">NULL</span>, nu02 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    mu01 <span class="op">=</span> <span class="cn">NULL</span>, mu02 <span class="op">=</span> <span class="cn">NULL</span>, sigma01 <span class="op">=</span> <span class="cn">NULL</span>, sigma02 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    mu1 <span class="op">=</span> <span class="fl">5</span>, mu2 <span class="op">=</span> <span class="fl">3</span>,  <span class="co"># Assume true effect of 2.0</span></span>
<span>    sigma1 <span class="op">=</span> <span class="fl">2</span>, sigma2 <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    r <span class="op">=</span> <span class="cn">NULL</span>, ne1 <span class="op">=</span> <span class="cn">NULL</span>, ne2 <span class="op">=</span> <span class="cn">NULL</span>, alpha01 <span class="op">=</span> <span class="cn">NULL</span>, alpha02 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    bar.ye1 <span class="op">=</span> <span class="cn">NULL</span>, bar.ye2 <span class="op">=</span> <span class="cn">NULL</span>, se1 <span class="op">=</span> <span class="cn">NULL</span>, se2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    seed <span class="op">=</span> <span class="fl">123</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    sample_size <span class="op">=</span> <span class="va">n</span>,</span>
<span>    go_prob <span class="op">=</span> <span class="va">result</span><span class="op">$</span><span class="va">Go</span>,</span>
<span>    nogo_prob <span class="op">=</span> <span class="va">result</span><span class="op">$</span><span class="va">NoGo</span>,</span>
<span>    gray_prob <span class="op">=</span> <span class="va">result</span><span class="op">$</span><span class="va">Gray</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">oc_results_n</span><span class="op">)</span></span>
<span><span class="co">#&gt;   sample_size   go_prob  nogo_prob gray_prob</span></span>
<span><span class="co">#&gt; 1          10 0.4000000 0.13333333 0.4666667</span></span>
<span><span class="co">#&gt; 2          20 0.4666667 0.00000000 0.5333333</span></span>
<span><span class="co">#&gt; 3          30 0.6000000 0.03333333 0.3666667</span></span>
<span><span class="co">#&gt; 4          40 0.6666667 0.00000000 0.3333333</span></span>
<span><span class="co">#&gt; 5          50 0.5666667 0.00000000 0.4333333</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Reshape for plotting</span></span>
<span><span class="va">power_plot_data</span> <span class="op">&lt;-</span> <span class="va">oc_results_n</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">go_prob</span>, <span class="va">gray_prob</span>, <span class="va">nogo_prob</span><span class="op">)</span>, </span>
<span>               names_to <span class="op">=</span> <span class="st">"decision"</span>, </span>
<span>               values_to <span class="op">=</span> <span class="st">"probability"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Decision <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>    <span class="va">decision</span> <span class="op">==</span> <span class="st">"go_prob"</span> <span class="op">~</span> <span class="st">"Go"</span>,</span>
<span>    <span class="va">decision</span> <span class="op">==</span> <span class="st">"gray_prob"</span> <span class="op">~</span> <span class="st">"Gray"</span>,</span>
<span>    <span class="va">decision</span> <span class="op">==</span> <span class="st">"nogo_prob"</span> <span class="op">~</span> <span class="st">"NoGo"</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">power_plot_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">sample_size</span>, y <span class="op">=</span> <span class="va">probability</span>, color <span class="op">=</span> <span class="va">Decision</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Go"</span> <span class="op">=</span> <span class="st">"#2E8B57"</span>, <span class="st">"Gray"</span> <span class="op">=</span> <span class="st">"#DAA520"</span>, <span class="st">"NoGo"</span> <span class="op">=</span> <span class="st">"#DC143C"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Power Analysis: Sample Size vs Decision Probability"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Sample Size (per arm)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Decision Probability"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"True treatment effect = 2.0, σ = 2"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/percent_format.html" class="external-link">percent</a></span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="continuous-endpoints_files/figure-html/power_plot-1.png" alt="Visualization of statistical methods and decision probabilities for continuous endpoints" width="768"></p>
</div>
</div>
<div class="section level2">
<h2 id="practical-guidelines">Practical Guidelines<a class="anchor" aria-label="anchor" href="#practical-guidelines"></a>
</h2>
<div class="section level3">
<h3 id="method-selection">Method Selection<a class="anchor" aria-label="anchor" href="#method-selection"></a>
</h3>
<p><strong>NI (Numerical Integration)</strong> - Most accurate -
Recommended for final analyses and regulatory submissions - Moderate
computational time</p>
<p><strong>WS (Welch-Satterthwaite)</strong> - Fast approximation - Good
for exploratory analyses and simulations - Very close to NI results in
most cases</p>
<p><strong>MC (Monte Carlo)</strong> - Flexible but slowest - Use when
other methods are not applicable - Requires careful selection of nMC
(typically 10,000+)</p>
</div>
<div class="section level3">
<h3 id="design-selection">Design Selection<a class="anchor" aria-label="anchor" href="#design-selection"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Controlled</strong>: Standard two-arm trial with concurrent
controls</li>
<li>
<strong>Uncontrolled</strong>: Single-arm when ethical/practical
constraints prevent randomization</li>
<li>
<strong>External</strong>: When incorporating historical data can
reduce sample size requirements</li>
</ol>
</div>
<div class="section level3">
<h3 id="threshold-selection">Threshold Selection<a class="anchor" aria-label="anchor" href="#threshold-selection"></a>
</h3>
<ul>
<li>
<strong>θ_TV (Target Value)</strong>: Clinically meaningful
difference</li>
<li>
<strong>θ_MAV (Minimum Acceptable Value)</strong>: Smallest
worthwhile effect</li>
<li>
<strong>γ₁ (Go threshold)</strong>: 0.7-0.9 depending on risk
tolerance</li>
<li>
<strong>γ₂ (NoGo threshold)</strong>: 0.2-0.4 for early
stopping</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>This vignette demonstrated:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Basic probability calculations</strong> for continuous
endpoints</li>
<li>
<strong>Method comparison</strong> (NI, WS, MC)</li>
<li>
<strong>Go/NoGo/Gray decision framework</strong> implementation</li>
<li>
<strong>Operating characteristics</strong> evaluation</li>
<li>
<strong>Prior specification</strong> (vague vs informative)</li>
<li>
<strong>External control design</strong> with power priors</li>
<li>
<strong>Sample size and power</strong> considerations</li>
</ol>
<p>The BayesianQDM package provides flexible and rigorous tools for
Bayesian decision-making in clinical trials with continuous
endpoints.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>For more details on the statistical methods, see:</p>
<ul>
<li>The main BayesianQDM vignette for framework overview</li>
<li>Function documentation for parameter specifications</li>
<li>The binary endpoints vignette for analysis of discrete outcomes</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gosuke Homma, Yusuke Yamaguchi.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
